---
import PageLayout from "@/layouts/page-layout.astro";
import Box from "@/components/box/index.astro";
import BoxContent from "@/components/box/content.astro";
import BoxHeader from "@/components/box/header.astro";
import BoxTitle from "@/components/box/title.astro";
import GithubIcon from "@/components/ui/icons/github.astro";
import {
  FRONTEND_PROJECTS,
  FRONTEND_STATS,
  type FrontendProject,
} from "@/lib/constants/frontend-projects";

const getDifficultyColor = (difficulty: string) => {
  switch (difficulty) {
    case "Newbie":
      return "bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";
    case "Junior":
      return "bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";
    case "Intermediate":
      return "bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";
    case "Advanced":
      return "bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";
    case "Guru":
      return "bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400";
    default:
      return "bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";
  }
};
---

<PageLayout
  title="Frontend Challenges"
  description="My Frontend Mentor projects â€“ frontend development challenges"
>
  <Box className="screen-line-after">
    <BoxHeader>
      <a
        href="https://www.frontendmentor.io/profile/rojasmart"
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center rounded-md bg-primary px-4 py-2 text-primary-foreground transition-colors hover:bg-primary/90"
      >
        See Profile Frontend Mentor
      </a>
    </BoxHeader>

    <BoxContent>
      <div class="mb-8">
        <!-- Filter Buttons -->
        <div class="mb-6">
          <h3 class="mb-3 text-lg font-semibold">Filter by Difficulty</h3>
          <div class="flex flex-wrap gap-2">
            <button
              class="filter-btn active rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground transition-all"
              data-filter="all"
            >
              All ({FRONTEND_STATS.totalProjects})
            </button>
            <button
              class="filter-btn rounded-lg bg-green-100 px-4 py-2 text-sm font-medium text-green-800 transition-all hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/40"
              data-filter="newbie"
            >
              Newbie ({FRONTEND_STATS.difficulties.newbie})
            </button>
            <button
              class="filter-btn rounded-lg bg-blue-100 px-4 py-2 text-sm font-medium text-blue-800 transition-all hover:bg-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:bg-blue-900/40"
              data-filter="junior"
            >
              Junior ({FRONTEND_STATS.difficulties.junior})
            </button>
            <button
              class="filter-btn rounded-lg bg-yellow-100 px-4 py-2 text-sm font-medium text-yellow-800 transition-all hover:bg-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:hover:bg-yellow-900/40"
              data-filter="intermediate"
            >
              Intermediate ({FRONTEND_STATS.difficulties.intermediate})
            </button>
            <button
              class="filter-btn rounded-lg bg-red-100 px-4 py-2 text-sm font-medium text-red-800 transition-all hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/40"
              data-filter="advanced"
            >
              Advanced ({FRONTEND_STATS.difficulties.advanced})
            </button>
            <button
              class="filter-btn rounded-lg bg-purple-100 px-4 py-2 text-sm font-medium text-purple-800 transition-all hover:bg-purple-200 dark:bg-purple-900/20 dark:text-purple-400 dark:hover:bg-purple-900/40"
              data-filter="guru"
            >
              Guru ({FRONTEND_STATS.difficulties.guru})
            </button>
          </div>
        </div>
      </div>

      <div
        class="grid grid-cols-[repeat(auto-fill,minmax(250px,1fr))] gap-3"
        id="projects-grid"
      >
        {
          FRONTEND_PROJECTS.slice(0, 20).map(project => (
            <a
              href={project.demoUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="project-card group block overflow-hidden rounded-lg border border-border bg-card transition-all duration-200 hover:border-primary/20 hover:shadow-lg"
              data-difficulty={project.difficulty.toLowerCase()}
              data-category={project.category
                ?.toLowerCase()
                .replace("/", "-")
                .replace(" ", "-")}
            >
              >{/* Image Preview */}
              <div class="relative aspect-video overflow-hidden bg-muted">
                {project.image ? (
                  <img
                    src={project.image}
                    alt={project.title}
                    class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-110"
                  />
                ) : (
                  <div class="flex h-full w-full items-center justify-center bg-gradient-to-br from-primary/5 to-primary/10">
                    <div class="text-6xl opacity-10">ðŸŽ¨</div>
                  </div>
                )}
                <div class="absolute top-2 right-2">
                  <span
                    class={`rounded-full px-2 py-1 text-xs ${getDifficultyColor(project.difficulty)} shadow-sm`}
                  >
                    {project.difficulty}
                  </span>
                </div>
                {/* Overlay on hover */}
                <div class="absolute inset-0 bg-black/0 transition-colors duration-200 group-hover:bg-black/10" />
              </div>
              {/* Content */}
              <div class="p-6">
                <h3 class="mb-3 text-lg font-semibold transition-colors group-hover:text-primary">
                  {project.title}
                </h3>
                <p class="mb-4 line-clamp-2 text-sm leading-relaxed text-muted-foreground">
                  {project.description}
                </p>

                {/* Tags */}
                <div class="mb-6 flex flex-wrap gap-2">
                  {project.tags.map(tag => (
                    <span class="rounded-full bg-secondary/80 px-3 py-1 text-xs font-medium text-secondary-foreground">
                      {tag}
                    </span>
                  ))}
                </div>

                {/* Action Buttons */}
                <div class="flex gap-2">
                  <div class="flex-1 rounded-md bg-primary/10 px-3 py-2 text-center text-sm text-primary transition-colors group-hover:bg-primary group-hover:text-primary-foreground">
                    Demo
                  </div>
                  <button
                    onclick={`event.preventDefault(); event.stopPropagation(); window.open('${project.repoUrl}', '_blank')`}
                    class="flex items-center justify-center rounded-md border border-border px-3 py-2 transition-colors hover:bg-secondary"
                    title="Ver cÃ³digo no GitHub"
                  >
                    <GithubIcon className="w-4 h-4" />
                  </button>
                  <button
                    onclick={`event.preventDefault(); event.stopPropagation(); window.open('${project.challengeUrl}', '_blank')`}
                    class="rounded-md border border-border px-3 py-2 text-sm transition-colors hover:bg-secondary"
                    title="Ver desafio original"
                  >
                    Challenge
                  </button>
                </div>
              </div>
            </a>
          ))
        }
      </div>
    </BoxContent>
  </Box>
</PageLayout>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const filterButtons = document.querySelectorAll(".filter-btn");
    const projectCards = document.querySelectorAll(".project-card");

    filterButtons.forEach(button => {
      button.addEventListener("click", function () {
        const filterValue = this.getAttribute("data-filter");

        // Update active button
        filterButtons.forEach(btn => {
          btn.classList.remove("active");
          if (btn !== this) {
            btn.classList.add("opacity-70");
          }
        });

        this.classList.add("active");
        this.classList.remove("opacity-70");

        // Filter projects with animation
        projectCards.forEach(card => {
          if (filterValue === "all") {
            card.style.display = "block";
            card.style.opacity = "0";
            setTimeout(() => {
              card.style.opacity = "1";
            }, 50);
          } else {
            const cardDifficulty = card.getAttribute("data-difficulty");
            if (cardDifficulty === filterValue) {
              card.style.display = "block";
              card.style.opacity = "0";
              setTimeout(() => {
                card.style.opacity = "1";
              }, 50);
            } else {
              card.style.opacity = "0";
              setTimeout(() => {
                card.style.display = "none";
              }, 200);
            }
          }
        });
      });
    });
  });
</script>

<style>
  .project-card {
    transition: opacity 0.2s ease-in-out;
  }

  .filter-btn {
    transition: all 0.2s ease-in-out;
  }

  .filter-btn:not(.active) {
    opacity: 0.7;
  }

  .filter-btn.active {
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  }
</style>
